{"version":3,"sources":["index.js"],"names":["modalClose","phoneNumberTextBox","HOST","cleanupModal","setModalLoader","setModalTitle","setModalInputArea","setModalInputPlaceHolder","setModalInputValue","setModalInfoMessage","setModalErrorMessage","openModal","targetElement","callBack","modal","document","querySelector","overlay","modalCloseButton","classList","remove","setTimeout","add","removeEventListener","addEventListener","title","modalTitleNode","innerHTML","getModalUserInput","value","getInputValue","selector","visibility","placeholderString","setAttribute","validatePhoneNumber","phoneNumber","test","trim","error","errorMessage","onSubmitButtonClicked","removeSubmitEventListener","fn","message","messageArea","sendOtp","target","targetInputSelector","id","fetch","then","resp","json","console","log","code","collectOTP","catch","validateOTP","otp","onOTPSubmitCallback","e","preventDefault","verifyOTP","isSuccessful","currentLocation","params","URL","window","location","searchParams","payload","utm_campaign","get","utm_medium","utm_source","method","headers","body","JSON","stringify","data","user","email","thankUser","collectEmail","token","validateEmail","onEmailSubmitCallback","submitEmail","encodeURIComponent","inputNode","onload","navOpenButton","navLinks","navCloseButton","getAccessForms","querySelectorAll","forEach","button"],"mappings":"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","file":"src.7e423621.js","sourceRoot":"..\\src","sourcesContent":["import \"./styles.scss\";\nconst HOST = 'https://stage.savemo.app';\n\nwindow.onload = () => {\n    let navOpenButton = document.querySelector('#navOpenButton');\n    let navLinks = document.querySelector('#navLinks');\n    let navCloseButton = document.querySelector('#navCloseButton');\n\n    let getAccessForms = document.querySelectorAll('#getAccessHero, #getAccessBanner');\n\n    navOpenButton.addEventListener('click', function () {\n        navOpenButton.setAttribute('aria-expanded', \"true\");\n        navLinks.classList.add('duration-150', 'ease-out')\n        navLinks.classList.remove('hidden');\n        setTimeout(function () {\n            navLinks.classList.add('opacity-100', 'scale-100');\n            navLinks.classList.remove('opacity-0', 'scale-95');\n        }, 2);\n    });\n\n    navCloseButton.addEventListener('click', () => {\n        navOpenButton.setAttribute('aria-expanded', \"false\");\n        navLinks.classList.remove('duration-150', 'ease-out', 'opacity-100', 'scale-100');\n        navLinks.classList.add('duration-100', 'ease-in', 'opacity-0', 'scale-95');\n\n        setTimeout(() => {\n            navLinks.classList.add('hidden');\n        }, 150);\n    });\n\n    getAccessForms && getAccessForms.forEach((button) => {\n        button.addEventListener('submit', (e) => {\n            e.preventDefault();\n            openModal(e.target, sendOtp);\n        });\n    });\n};\n\nlet modalClose, phoneNumberTextBox;\n\nfunction cleanupModal () {\n    setModalLoader(false);\n    setModalTitle(false);\n    setModalInputArea(false);\n    setModalInputPlaceHolder(\"\");\n    setModalInputValue(\"\");\n    setModalInfoMessage(\"\");\n    setModalErrorMessage(\"\");\n}\n\nfunction openModal (targetElement, callBack) {\n    let modal = document.querySelector('#modal');\n    let overlay = document.querySelector('#modalOverlay');\n    let modalCloseButton = document.querySelector('#closeModal');\n\n    phoneNumberTextBox = targetElement;\n\n    modal.classList.remove('hidden');\n    overlay.classList.remove('hidden');\n\n    setTimeout(() => {\n        modal.classList.add('duration-150', 'ease-out', 'opacity-100', 'scale-100');\n        overlay.classList.add('duration-150', 'ease-out', 'opacity-80');\n\n        modal.classList.remove('opacity-0', 'scale-95');\n        overlay.classList.remove('opacity-0');\n    }, 2);\n\n    modalClose = () => {\n\n        modal.classList.remove('opacity-100', 'scale-100', 'duration-150', 'ease-out');\n        overlay.classList.remove('opacity-80', 'duration-150', 'ease-out');\n\n        modal.classList.add('duration-100', 'ease-in', 'opacity-0', 'scale-95');\n        overlay.classList.add('duration-100', 'ease-in', 'opacity-0');\n\n        setTimeout(() => {\n            modal.classList.add('hidden');\n            overlay.classList.add('hidden');\n        }, 150);\n\n        cleanupModal();\n\n        modalCloseButton.removeEventListener('click', modalClose);\n    };\n\n    modalCloseButton.addEventListener('click', modalClose);\n\n    callBack && callBack(targetElement);\n\n}\n\nfunction setModalTitle (title) {\n    let modalTitleNode = document.querySelector('#modalTitle');\n    modalTitleNode.innerHTML = title;\n\n    if (title)\n        modalTitleNode.classList.remove('hidden');\n    else\n        modalTitleNode.classList.add('hidden');\n}\n\nfunction getModalUserInput () {\n    return document.querySelector('#userInput').value;\n}\n\nfunction getInputValue (selector) {\n    return document.querySelector(selector)?.value;\n}\n\nfunction setModalLoader (visibility) {\n    if (visibility)\n        document.querySelector('#modalLoader').classList.remove('hidden');\n    else\n        document.querySelector('#modalLoader').classList.add('hidden');\n}\n\nfunction setModalInputPlaceHolder (placeholderString) {\n    document.querySelector(\"#userInput\").setAttribute(\"placeholder\", placeholderString);\n}\n\nfunction validatePhoneNumber (phoneNumber) {\n    return phoneNumber && /\\d{10,10}/.test(phoneNumber.trim());\n}\n\nfunction setModalErrorMessage (error) {\n    let errorMessage = document.querySelector('#modalErrorMessage');\n    errorMessage.innerHTML = error;\n\n    if (error)\n        errorMessage.classList.remove('hidden');\n    else\n        errorMessage.classList.add('hidden');\n}\n\nfunction setModalInputArea (visibility) {\n    if (visibility) {\n        document.querySelector('#inputArea').classList.remove('hidden');\n    } else {\n        document.querySelector('#inputArea').classList.add('hidden');\n    }\n}\n\nfunction onSubmitButtonClicked (callBack) {\n    const userInput = document.querySelector('#userInputSubmit');\n    userInput.addEventListener('submit', callBack);\n}\n\nfunction removeSubmitEventListener (fn) {\n    const userInput = document.querySelector('#userInputSubmit');\n    userInput.removeEventListener('submit', fn);\n}\n\nfunction setModalInputValue (value) {\n    document.querySelector('#userInput').value = value;\n}\n\nfunction setModalInfoMessage (message) {\n    const messageArea = document.querySelector('#modalMessage');\n    messageArea.innerHTML = message;\n\n    if (message) {\n        messageArea.classList.remove('hidden');\n    } else {\n        messageArea.classList.add('hidden');\n    }\n}\n\nfunction sendOtp (target) {\n    const targetInputSelector = `#${target.id}-input`;\n\n    const phoneNumber = getInputValue(targetInputSelector);\n\n    if (!validatePhoneNumber(phoneNumber)) {\n        setModalTitle(\"Please enter a valid phone number and try again\");\n        return\n    }\n\n    setModalLoader(true);\n\n    fetch(`${HOST}/waitlist/send_otp/${phoneNumber}`)\n    .then(resp => resp.json())\n    .then(resp => {\n        setModalLoader(false);\n        console.log(resp);\n\n        if (resp.code === 2000) {\n            collectOTP(phoneNumber);\n\n            return true;\n        } else {\n            setModalErrorMessage(\"Something went wrong from our end. Please try again later\");\n        }\n    })\n    .catch(resp => {\n        setModalLoader(false);\n        setModalErrorMessage(\"Something went wrong. Failed to submit phone number\");\n    });\n}\n\nfunction validateOTP (otp) {\n    return otp && /^\\d{4,4}$/.test(otp.trim());\n}\n\nfunction collectOTP (phoneNumber) {\n    setModalTitle(\"Let's verify your number\");\n    setModalInputArea(true);\n    setModalInputPlaceHolder(\"OTP\");\n\n    const onOTPSubmitCallback = (e) => {\n        e.preventDefault();\n        const otp = getModalUserInput();\n\n        if (validateOTP(otp)) {\n            verifyOTP(otp, phoneNumber)\n            .then((isSuccessful) => {\n                isSuccessful && removeSubmitEventListener(onOTPSubmitCallback);\n            });\n        } else {\n            setModalErrorMessage(\"Invalid OTP\");\n        }\n    };\n\n    onSubmitButtonClicked(onOTPSubmitCallback);\n}\n\n\nfunction verifyOTP (otp, phoneNumber) {\n    const currentLocation = new URL(window.location);\n    const params = currentLocation.searchParams;\n    const payload = {\n        otp,\n        utm_campaign: params.get('utm_campaign'),\n        utm_medium: params.get('utm_medium'),\n        utm_source: params.get('utm_source')\n    };\n\n    setModalInputArea(false);\n    setModalLoader(true);\n\n    return fetch(`${HOST}/waitlist/${phoneNumber}`, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(payload)\n    })\n    .then(resp => resp.json())\n    .then(resp => {\n        setModalLoader(false);\n\n        console.log(resp);        \n        if (resp.code === 2000) {\n            if (!resp.data?.user?.email) {\n                collectEmail(phoneNumber, resp.data.token);\n            } else {\n                thankUser();\n            }\n            \n            return true;\n        } else {\n            setModalInputArea(true);\n            setModalErrorMessage(\"Invalid OTP\");\n        }\n    })\n    .catch(() => {\n        setModalLoader(false);\n        setModalInputArea(true);\n        setModalErrorMessage(\"Something went wrong while submitting OTP\");\n    });\n}\n\nfunction validateEmail (email) {\n    return email && /.+@\\..+/.test();\n}\n\nfunction collectEmail (phoneNumber, token) {\n    setModalTitle(\"Email\");\n    setModalInputArea(true);\n    setModalErrorMessage(\"\");\n    setModalInputValue(\"\");\n\n    setModalInputPlaceHolder(\"Email\");\n\n    const onEmailSubmitCallback = (e) => {\n        e.preventDefault();\n        const email = getModalUserInput();\n\n        if (validateEmail(email)) {\n            submitEmail(email, phoneNumber, token)\n            .then((isSuccessful) => {\n                isSuccessful && removeSubmitEventListener(onEmailSubmitCallback);\n            });\n        } else {\n            setModalErrorMessage(\"Invalid email\");\n        }\n    };\n\n    onSubmitButtonClicked(onEmailSubmitCallback);\n}\n\nfunction submitEmail (email, phoneNumber, token) {\n    const payload = {\n        token\n    };\n\n    setModalInputArea(false);\n    setModalLoader(true);\n\n    return fetch(`${HOST}/waitlist/${phoneNumber}/${window.encodeURIComponent(email)}`, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(payload)\n    })\n    .then(resp => resp.json())\n    .then(resp => {\n        setModalLoader(false);\n        if (resp.code === 2000) {\n            thankUser();\n\n            return true;\n        } else {\n            setModalInputArea(true);\n            setModalErrorMessage(\"Error while submitting email\");\n        }\n    })\n    .catch(() => {\n        setModalInputArea(true);\n        setModalLoader(false)\n        setModalErrorMessage(\"Failed to submit email\")\n    });\n}\n\nfunction thankUser () {\n    setModalInputArea(false);\n    setModalErrorMessage(\"\");\n    setModalTitle(\"All done!\");\n    setModalInfoMessage(\"You've been added to the waitlist\");\n\n    if(phoneNumberTextBox) {\n        // Clear phone number after everything is successful\n        const selector = `#${phoneNumberTextBox.id}-input`;\n        const inputNode = document.querySelector(selector);\n\n        if (inputNode) {\n            inputNode.value = \"\";\n        }\n    }\n\n    setTimeout(() => {\n        \n        modalClose && modalClose();\n    }, 3000);\n}"]}